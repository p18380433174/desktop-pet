# 流萤桌面宠物 (Firefly Desktop Pet)

基于 PyQt5 开发的高交互式桌面宠物程序，目前以《崩坏：星穹铁道》中的流萤为核心角色，支持丰富的动画、音效及自定义扩展。

## 🌟 核心功能

- **动态动画系统**：支持加载序列帧动画，并提供“保持循环”与“自动随机切换”两种播放模式。
- **高交互性设计**：
    - **单击交互**：点击触发随机动作并弹出对话气泡。
    - **连击反馈**：连续点击 3 次以上触发特殊的“气鼓鼓”动画，具备高优先级拦截逻辑，必须完整播放。
    - **平滑拖动**：拖动时触发专属拖动动作，释放后自动恢复拖动前的动画进度（精准到帧）。
- **个性化调整**：
    - **等比缩放**：支持 50% - 200% 的等比缩放，保持人物横纵比。
    - **动作选单**：右键菜单可实时预览并切换角色支持的所有动作。
- **系统集成**：
    - **状态记忆**：自动保存位置、缩放比例、音效设置等配置。
    - **系统托盘**：支持显示/隐藏、音效开关、对话开关及快速退出。

## 📁 项目结构

```text
firefly_pet/
├── assets/
│   └── characters/         # 角色资源根目录
│       └── firefly/        # 角色目录（流萤）
│           ├── animations/ # 动作序列帧目录
│           └── icon/       # 角色专属ico图标
├── main.py                 # 程序入口
├── pet.py                  # 核心交互逻辑
├── animation.py            # 动画加载与播放管理
└── config.py               # 配置文件与路径管理
```

## 🚀 快速开始

### 环境要求
- Windows 10/11
- Python 3.8+

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python firefly_pet/main.py
```

## 🎨 如何扩展新角色

项目采用了语义化目录结构，你可以通过以下步骤添加新角色：

1. **准备资源**：
   在 `assets/characters/` 下新建角色文件夹（例如 `kafka`）。
2. **组织动作**：
   在角色文件夹下创建 `animations/` 目录，并为每个动作建立子文件夹：
   - `站立/` (默认动作)
   - `气鼓鼓/` (连击触发)
   - `拖动/` (拖动触发)
   - 其他自定义动作（会自动显示在右键“改变动作”列表中）
3. **命名规则**：
   图片命名建议为 `frame001.png`, `frame002.png` ... 等。
4. **图标与配置**：
   - 在 `icon/` 目录下放置 `.ico` 图标。
   - 在 `config.json` 中将 `"character"` 修改为你的角色文件夹名称。

## 🛠️ 控制说明

- **左键单击**：随机动作 + 对话。
- **左键连击**：触发“气鼓鼓”。
- **左键拖动**：移动位置。
- **右键菜单**：切换动画模式、调整比例、改变动作、退出程序。
